<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.elmo.robella.mapper.RequestLogMapper">

    <select id="findByUserId" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE user_id = #{userId} ORDER BY created_at DESC
    </select>

    <select id="findByUserIdAndCreatedAtBetween" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log
        WHERE user_id = #{userId} AND created_at BETWEEN #{startTime} AND #{endTime}
        ORDER BY created_at DESC
    </select>

    <select id="findByApiKeyId" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE api_key_id = #{apiKeyId} ORDER BY created_at DESC
    </select>

    <select id="findByProviderId" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE provider_id = #{providerId} ORDER BY created_at DESC
    </select>

    <select id="findByModelKey" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE model_key = #{modelKey} ORDER BY created_at DESC
    </select>

    <select id="findByEndpointType" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE endpoint_type = #{endpointType} ORDER BY created_at DESC
    </select>

    <select id="findByIsSuccess" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log WHERE is_success = #{isSuccess} ORDER BY created_at DESC
    </select>

    <select id="findByCreatedAtBetween" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log
        WHERE created_at BETWEEN #{startTime} AND #{endTime}
        ORDER BY created_at DESC
    </select>

    <select id="findByUserIdAndIsSuccess" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log
        WHERE user_id = #{userId} AND is_success = #{isSuccess}
        ORDER BY created_at DESC
    </select>

    <select id="countByUserIdAndCreatedAtBetween" resultType="java.lang.Long">
        SELECT COUNT(*) FROM request_log
        WHERE user_id = #{userId} AND created_at BETWEEN #{startTime} AND #{endTime}
    </select>

    <select id="findTop100ByOrderByCreatedAtDesc" resultType="org.elmo.robella.model.entity.RequestLog">
        SELECT * FROM request_log ORDER BY created_at DESC LIMIT 100
    </select>

</mapper>